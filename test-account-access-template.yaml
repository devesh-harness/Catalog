apiVersion: scaffolder.backstage.io/v1beta3
kind: Template
metadata:
  name: accountaccess
  title: Provide access to Harness account
  description: Template for providing access to Harness account
  tags:
    - access
    - harness
spec:
  owner: sandeepa.kv@harness.io
  type: service
  parameters:
    - title: Harness Details
      required:
        - user_email
        - account_id
      properties:
        account_id:
          title: Harness account ID
          type: string
          description: Harness account ID where you need access
        user_email:
          title: Harness user email ID
          type: string
          description: Harness user email id who need access
        token:
          title: Harness Token
          type: string
          ui:widget: password
          ui:field: HarnessAuthToken
  steps:
    - id: trigger
      name: Inviting user to account
      action: trigger:harness-custom-pipeline
      input:
        url: 'https://harness0.harness.io/ng/account/l7B_kbSEQD2wjrM7PShm5w/all/orgs/PROD/projects/IDP/pipelines/grant_access_to_used_in_account/pipeline-studio/?storeType=INLINE'
        inputset:
          user_email: ${{ parameters.user_email }}
          account_id: ${{ parameters.account_id }}
        apikey: ${{ parameters.token }}   
  output:
    links:
      - title: Pipeline Details
        url: ${{ steps.trigger.output.PipelineUrl }}             
